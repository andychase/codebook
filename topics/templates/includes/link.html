<div class="link_block" id="{{ resource.id }}">
    {% if link.commentary or editing %}
        <div class="commentary" {{ editing }}>
        <span>
            {% if editing %}
                {{ link.commentary | un_markdownify }}
            {% else %}
                {{ link.commentary | markdownify }}
            {% endif %}
        </span>
        </div>
    {% endif %}

    <div class="icon {% if "opinion" in link.type %}mirror{% endif %}">
        <span class="{{ link.type }}"></span>
        <span class="{{ site.resource_type_to_icon_map | get_item:link.type }}"></span>
        {% if "opinion" in link.type %}
            <span class="opinion {{ site.resource_type_to_icon_map_opinion | get_item:link.type }}"></span>
        {% endif %}
    </div>
    {% if editing %}
        <h3 class="link_url" {{ editing }}>{{ link.title | un_markdownify }}</h3>
        <label>
            <input class="editing-link-url" name="url" value="{{ link.url.2 }}">
        </label>
    {% else %}
        <a class="link_url" href="{{ link.url.2 }}">
            {{ link.title | markdownify }}
        </a>
    {% endif %}
    <div class="more_link_data" {{ editing }}>
        {% if editing %}
            {{ link.metadata | un_markdownify}}
        {% else %}
            {{ link.metadata | markdownify }}
        {% endif %}
    </div>

    {% if link.desc or editing %}
        <div class="description" {{ editing }}>
            {% if editing %}
                {{ link.desc | un_markdownify }}
            {% else %}
                {{ link.desc | markdownify }}
            {% endif %}
        </div>
    {% endif %}

    {% if not editing %}
        {% include 'includes/feedback_form.html' with feedback_title=link.title %}
    {% endif %}

</div>
